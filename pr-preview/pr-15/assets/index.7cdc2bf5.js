import{c as V,j as a,g as J,a as K,s as $,_ as v,r as u,u as X,b as Z,d as ee,e as ae,f,h as b,i as W,k as d,L as te,S as F,B as C,T as re,l as ne,F as Y,m as z,A as D,n as I,o as se,p as x,q as M,P as ie,G as oe,t as le,C as ce,v as L,w as de,x as ue,y as k,z as pe,D as me,N as he,I as _e,E as Q,H as R,J as U,K as ge,M as ve,O as fe,Q as be,R as ye,U as Ae,V as Se,W as j,X as ke,Y as xe,Z as Ne,$ as we,a0 as Pe,a1 as Le,a2 as Ce,a3 as Me,a4 as De,a5 as Ee}from"./index.6c9246b2.js";var Re=V(a("path",{d:"M12 12c2.21 0 4-1.79 4-4s-1.79-4-4-4-4 1.79-4 4 1.79 4 4 4zm0 2c-2.67 0-8 1.34-8 4v2h16v-2c0-2.66-5.33-4-8-4z"}),"Person");function Te(e){return J("MuiAvatar",e)}K("MuiAvatar",["root","colorDefault","circular","rounded","square","img","fallback"]);const Oe=["alt","children","className","component","imgProps","sizes","src","srcSet","variant"],Fe=e=>{const{classes:t,variant:n,colorDefault:r}=e;return ee({root:["root",n,r&&"colorDefault"],img:["img"],fallback:["fallback"]},Te,t)},Ie=$("div",{name:"MuiAvatar",slot:"Root",overridesResolver:(e,t)=>{const{ownerState:n}=e;return[t.root,t[n.variant],n.colorDefault&&t.colorDefault]}})(({theme:e,ownerState:t})=>v({position:"relative",display:"flex",alignItems:"center",justifyContent:"center",flexShrink:0,width:40,height:40,fontFamily:e.typography.fontFamily,fontSize:e.typography.pxToRem(20),lineHeight:1,borderRadius:"50%",overflow:"hidden",userSelect:"none"},t.variant==="rounded"&&{borderRadius:(e.vars||e).shape.borderRadius},t.variant==="square"&&{borderRadius:0},t.colorDefault&&v({color:(e.vars||e).palette.background.default},e.vars?{backgroundColor:e.vars.palette.Avatar.defaultBg}:{backgroundColor:e.palette.mode==="light"?e.palette.grey[400]:e.palette.grey[600]}))),Ve=$("img",{name:"MuiAvatar",slot:"Img",overridesResolver:(e,t)=>t.img})({width:"100%",height:"100%",textAlign:"center",objectFit:"cover",color:"transparent",textIndent:1e4}),$e=$(Re,{name:"MuiAvatar",slot:"Fallback",overridesResolver:(e,t)=>t.fallback})({width:"75%",height:"75%"});function ze({crossOrigin:e,referrerPolicy:t,src:n,srcSet:r}){const[s,c]=u.exports.useState(!1);return u.exports.useEffect(()=>{if(!n&&!r)return;c(!1);let l=!0;const i=new Image;return i.onload=()=>{!l||c("loaded")},i.onerror=()=>{!l||c("error")},i.crossOrigin=e,i.referrerPolicy=t,i.src=n,r&&(i.srcset=r),()=>{l=!1}},[e,t,n,r]),s}const Qe=u.exports.forwardRef(function(t,n){const r=X({props:t,name:"MuiAvatar"}),{alt:s,children:c,className:l,component:i="div",imgProps:o,sizes:h,src:y,srcSet:_,variant:A="circular"}=r,N=Z(r,Oe);let g=null;const E=ze(v({},o,{src:y,srcSet:_})),w=y||_,P=w&&E!=="error",p=v({},r,{colorDefault:!P,component:i,variant:A}),S=Fe(p);return P?g=a(Ve,v({alt:s,src:y,srcSet:_,sizes:h,ownerState:p,className:S.img},o)):c!=null?g=c:w&&s?g=s[0]:g=a($e,{className:S.fallback}),a(Ie,v({as:i,ownerState:p,className:ae(S.root,l),ref:n},N,{children:g}))});var q=Qe,Ue=V(a("path",{d:"M6 19c0 1.1.9 2 2 2h8c1.1 0 2-.9 2-2V7H6v12zM19 4h-3.5l-1-1h-5l-1 1H5v2h14V4z"}),"Delete"),je=V(a("path",{d:"M3 17.25V21h3.75L17.81 9.94l-3.75-3.75L3 17.25zM20.71 7.04c.39-.39.39-1.02 0-1.41l-2.34-2.34a.9959.9959 0 0 0-1.41 0l-1.83 1.83 3.75 3.75 1.83-1.83z"}),"Edit");const qe="_header_1v0tx_1",Be="_header__link_1v0tx_13",He="_header__wrapper_1v0tx_19";var T={header:qe,header__link:Be,header__wrapper:He};const Ge=()=>{const e=f(),{searchParams:t}=b(),n=W(),r=async()=>{await re.remove(),e(ne(!1))},s=()=>{n({pathname:"/create",search:t})};return a("div",{className:T.header,children:d("div",{className:T.header__wrapper,children:[a(te,{className:T.header__link,to:"/",children:"JSCamp 2022 - Anime Saritasa"}),d(F,{direction:"row",gap:2,children:[a(C,{variant:"contained",color:"secondary",onClick:r,children:"Log out"}),a(C,{variant:"contained",color:"warning",onClick:s,children:"Create new anime"})]})]})})};var We={"default-layout":"_default-layout_rv8pr_1"};const Ye=({children:e})=>d(Y,{children:[a(Ge,{}),a("div",{className:We["default-layout"],children:e})]}),Je=Object.values(z).filter(e=>e!==z.Default).map(e=>({value:e})),Ke=()=>{const e=f(),{queryMethods:t,currentQueryParams:n}=b(),r=D.fromUrl(n),s=c=>{const l=c,i=l.map(o=>se.typeModelToDto[o]).join(",");t.set("types",i),e(x(new M({...r,types:l})))};return a(I,{id:"anime-filter",multiple:!0,defaultValue:r.types,label:"Filter by types",onChangeSideEffect:s,list:Je})};var m={"anime-item":"_anime-item_1cli0_1","anime-item_active":"_anime-item_active_1cli0_14","anime-item__thumb":"_anime-item__thumb_1cli0_18","anime-item__content":"_anime-item__content_1cli0_26","anime-popper__stack-button":"_anime-popper__stack-button_1cli0_31","anime-popper__button":"_anime-popper__button_1cli0_36","anime-popper__stack-wrapper":"_anime-popper__stack-wrapper_1cli0_40"};const Xe=({isOpen:e,anchorEl:t,onAction:n,onClose:r})=>a(ie,{onClick:s=>s.preventDefault(),open:e,anchorEl:t,role:void 0,placement:"bottom-end",transition:!0,sx:{zIndex:1},children:({TransitionProps:s})=>a(oe,{...s,children:a(le,{children:a(ce,{onClickAway:r,children:d(F,{className:m["anime-popper__stack-wrapper"],children:[d(L,{paddingY:"8px",children:["Are you sure to delete ",a("br",{})," this anime?"]}),d(F,{className:m["anime-popper__stack-button"],direction:"row",id:"composition-menu","aria-labelledby":"composition-button",children:[a(C,{variant:"contained",className:m["anime-popper__button"],onClick:n,children:"Yes"}),a(C,{color:"warning",variant:"contained",className:m["anime-popper__button"],onClick:r,children:"No"})]})]})})})})}),B=({animeInfo:e})=>{const{searchParams:t}=b(),{id:n}=de(),r=W(),[s,c]=u.exports.useState(),{enqueueSnackbar:l}=ue(),i=f(),o=({isActive:p})=>ge(m["anime-item"],(p||String(e.id)===n)&&m["anime-item_active"]),h=k(pe),y=k(me),[_,A]=u.exports.useState(!1),N=u.exports.useRef(null),g=async()=>{c(e.id),A(!1),await i(ve(e.id)),h!=null?l(h,{variant:"error"}):(l(`Delete anime ${e.titleEnglish} successfully!`,{variant:"success"}),n===String(e.id)&&r({pathname:"/",search:t}))},E=p=>{p.preventDefault(),r({pathname:`/edit/${e.id}`,search:t})},w=p=>{p.preventDefault(),A(S=>!S)},P=()=>{A(!1)};return d(he,{className:o,to:`/detail/${e.id}?${t}`,children:[e.image==null&&a(q,{alt:e.titleEnglish,src:_e.FallbackAvatar,className:m["anime-item__thumb"]}),e.image&&a(q,{alt:e.titleEnglish,src:e.image,className:m["anime-item__thumb"]}),d(Q,{className:m["anime-item__content"],children:[a(L,{children:R.replaceEmptyValue(e.titleEnglish)}),d(L,{children:["Status: ",R.replaceEmptyValue(e.status)]}),d(L,{children:["Type: ",R.replaceEmptyValue(e.type)]})]}),d(Q,{children:[a(U,{loading:s===e.id&&y,ref:N,id:"composition-button","aria-controls":_?"composition-menu":void 0,"aria-expanded":_?"true":void 0,"aria-haspopup":"true",color:"secondary",onClick:w,children:a(Ue,{})}),a(Xe,{isOpen:_,anchorEl:N.current,onAction:g,onClose:P}),a(U,{color:"secondary",onClick:E,children:a(je,{})})]})]})};var H={"anime-item":"_anime-item_130dq_1","anime-loading":"_anime-loading_130dq_5"};const Ze={root:null,rootMargin:"30px",threshold:.2},ea=()=>{const e=u.exports.useRef(null),t=k(fe),n=f(),r=k(be),s=ye(Ae),{currentQueryParams:c}=b(),l=k(Se);u.exports.useEffect(()=>{const o=D.fromUrl(c);n(x(o))},[]);const i=o=>{o[0].isIntersecting&&r&&n(ke(r))};return u.exports.useEffect(()=>{const o=new IntersectionObserver(i,Ze);return e.current&&o.observe(e.current),()=>{o.disconnect()}},[i]),t?a("div",{className:H["anime-loading"],children:a(j,{isBackdropLoading:!1})}):s.length===0?a("div",{children:"There is no result"}):d(Y,{children:[s?.map((o,h)=>h===s.length-1?a("div",{ref:e,className:H["anime-item"],children:a(B,{animeInfo:o})},o.id):a(B,{animeInfo:o},o.id)),l&&a(j,{isBackdropLoading:!1})]})},aa=u.exports.memo(ea);var ta={"anime-search__input":"_anime-search__input_1g9xt_1"};const ra=()=>{const{currentQueryParams:e,getQueryMethodWithKey:t}=b(),n=t("search"),{inputValue:r,setInputValue:s,debounceValue:c}=xe(n.get()??""),l=o=>{s(o.target.value)},i=f();return Ne(1,()=>{n.set(c);const o=D.fromUrl(e);i(x(new M({...o,search:c})))},[c]),a("div",{children:a(we,{value:r,onChange:l,className:ta["anime-search__input"],placeholder:"e.g.Naruto, ...",type:"search"})})},na=u.exports.memo(ra);var sa={"anime-sorting":"_anime-sorting_bbp2x_1"};const ia=Object.values(Pe).map(e=>({value:e})),oa=Object.values(Le).map(e=>({value:e})),la=()=>{const{currentQueryParams:e,queryMethods:t}=b(),n=f(),r=D.fromUrl(e),s=l=>{const i=l;t.set("sorting",Ce.toUrl(i)),n(x(new M({...r,sorting:i})))},c=l=>{const i=l;t.set("ordering",i),n(x(new M({...r,ordering:i})))};return d("div",{className:sa["anime-sorting"],children:[a(I,{defaultValue:r.sorting,onChangeSideEffect:s,id:"sort-anime",label:"Sort by",isNoneSelection:!0,list:ia}),a(I,{disabled:r.sorting==null,defaultValue:r.ordering,onChangeSideEffect:c,id:"order-anime",label:"Order by",list:oa})]})};var G={"anime-sidebar":"_anime-sidebar_2ycm1_1","anime-tab-group":"_anime-tab-group_2ycm1_15"};const ca=()=>d(Me,{component:"aside",className:G["anime-sidebar"],children:[a("div",{className:G["anime-tab-group"],children:a(De,{listTab:[{label:"Search",panel:a(na,{})},{label:"Filter",panel:a(Ke,{})},{label:"Sorting",panel:a(la,{})}]})}),a(aa,{})]}),da=u.exports.memo(ca);var O={"anime-table":"_anime-table_1dwu4_1","anime-table__content":"_anime-table__content_1dwu4_8"};const ua=()=>a(Ye,{children:d("div",{className:O["anime-table"],children:[a("div",{className:O["anime-table__sidebar"],children:a(da,{})}),a("div",{className:O["anime-table__content"],children:a(Ee,{})})]})}),ma=u.exports.memo(ua);export{ma as AnimeTablePage,ua as AnimeTablePageInner};
